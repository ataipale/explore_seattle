<!DOCTYPE html>
<meta charset="utf-8">
<style>

path {
  fill: none;
  stroke: #000;
  stroke-linejoin: round;
  stroke-linecap: round;
}

.dot {
  stroke: #0000ff;
  /*z-index: 2;*/
  fill: none;
}


</style>
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
<script>

var width = 960,
    height = 1160;

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);

// d3.json("seattle2_topo.json", function(error, seattle2_topo) {
//   if (error) return console.error(error);
//   console.log(seattle2_topo)

//   svg.append("path")
//       .datum(topojson.feature(seattle2_topo, seattle2_topo.objects.seattle2))
//       .attr("d", d3.geo.path().projection(d3.geo.mercator()));

//   var seattle2 = topojson.feature(seattle2_topo, seattle2_topo.objects.seattle2);

//   var projection = d3.geo.albers()
//       .center([0, 47.6])
//       .rotate([122.4, 0])
//       .parallels([40, 50])
//       .scale(3000000)
//       .translate([width / 2, height / 2]);

//   var path = d3.geo.path()
//     .projection(projection);

//   svg.append("path")
//       .datum(seattle2)
//       .attr("d", path);
// });


var projection = d3.geo.albersUsa()
    .scale(1280)
    .translate([width/2, height/2]);

// var projection = d3.geo.albers()
//     .center([0, 47.6])
//     .rotate([122.4, 0])
//     .parallels([40, 50])
//     .scale(1280)
//     .translate([width / 2, height / 2]);

var path = d3.geo.path()
    .projection(null); //projection); //null);
console.log(projection([-100,40]));

d3.json("us.json", function(error, us) {
  if (error) return console.error(error);
  // console.log(us);
  svg.append("path")
  .datum(topojson.feature(us, us.objects.nation))
  .attr("class", "land")
  .attr("d", path);
});

// function mercator(coordinates) {
//     return [
//       coordinates[0] / 360,
//       (-180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + coordinates[1] * Math.PI / 360))) / 360
//     ];
// }

console.log("ABOVE");
var coords = projection([-122.4, 47.6]);
console.log(coords);
// var my_rest=[];

d3.csv("sample.csv", function(error, data) {
  if (error) throw error;

  data.forEach(function(d) {
    d.category = d.category;
    d.long = d.long;
    d.lat = d.lat;
    console.log(data);
  });

  svg.selectAll(".dot")
    .data(data)
    // console.log(data);
    .enter().append("circle")
    .attr("class", "dot")
    .attr("r", 50)
    .attr("cx", function(d){
        // console.log(d);
        // console.log(d.longitude)
        console.log(d);
        console.log(projection([d.long, d.lat]));
        return projection([d.long, d.lat])[0];
        // console.log(g);
    })
    .attr("cy", function(d){
        return projection([d.long, d.lat])[1];
    });

});


</script>
